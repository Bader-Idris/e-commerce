import{_ as b,o as n,c as l,h as u,a as e,e as _,v as m,b as w,f as g,u as x,i as S}from"./index-bW6KImGH.js";const $={},k={class:"custom-loader"};function L(f,o){return n(),l("div",k)}const P=b($,[["render",L]]),T={class:"login"},U=e("h1",null,"Login",-1),V={class:"input-container"},q=e("label",{for:"email"},"Email",-1),B={class:"input-container"},H=e("label",{for:"password"},"Password",-1),M=["disabled"],N={key:0},O={key:1},C={__name:"Login",setup(f){const o=u(""),i=u(""),a=u(!1),h=async()=>{a.value=!0;const p="/api/v1/auth/login",s={email:o.value,password:i.value},t=new Headers;t.append("Content-Type","application/json");const v={method:"POST",headers:t,body:JSON.stringify(s),redirect:"follow"};try{const r=await fetch(p,v),c=await r.json();if(r.ok){const d={username:c.user.name,userId:c.user.userId,role:c.user.role};x().setUser(d),S("Successfully logged in",{theme:"auto",type:"success",position:"top-center",dangerouslyHTMLString:!0});const y=$route.query.redirect||"/protected";$router.push(y)}else{const d=$route.query.redirect||"/failed";$router.push(d)}}catch(r){console.error(r)}finally{a.value=!1}};return(p,s)=>(n(),l("div",T,[e("form",{class:"form",onSubmit:g(h,["prevent"])},[U,e("div",V,[q,_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.value=t),name:"email",type:"text",class:"input","aria-labelledby":"email"},null,512),[[m,o.value]])]),e("div",B,[H,_(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>i.value=t),name:"password",type:"password",class:"input","aria-labelledby":"password"},null,512),[[m,i.value]])]),e("button",{class:"btn",disabled:a.value},[a.value?(n(),l("span",N,[w(P)])):(n(),l("span",O," Login "))],8,M)],32)]))}};export{C as default};
