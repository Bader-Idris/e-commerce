import{_ as g,o as n,c as l,h as d,a as e,e as _,v as m,b as w,f as b,u as x,i as S}from"./index-BojetKus.js";const $={},k={class:"custom-loader"};function L(f,o){return n(),l("div",k)}const P=g($,[["render",L]]),T={class:"login"},U=e("h1",null,"Login",-1),V=e("label",{for:"email"},"email",-1),q=e("label",{for:"password"},"Password",-1),B=["disabled"],H={key:0},M={key:1},O={__name:"Login",setup(f){const o=d(""),i=d(""),a=d(!1),h=async()=>{a.value=!0;const p="/api/v1/auth/login",s={email:o.value,password:i.value},t=new Headers;t.append("Content-Type","application/json");const v={method:"POST",headers:t,body:JSON.stringify(s),redirect:"follow"};try{const r=await fetch(p,v),c=await r.json();if(r.ok){const u={username:c.user.name,userId:c.user.userId,role:c.user.role};x().setUser(u),S("Successfully logged in",{theme:"auto",type:"success",position:"top-center",dangerouslyHTMLString:!0});const y=$route.query.redirect||"/protected";$router.push(y)}else{const u=$route.query.redirect||"/failed";$router.push(u)}}catch(r){console.error(r)}finally{a.value=!1}};return(p,s)=>(n(),l("div",T,[e("form",{class:"form",onSubmit:b(h,["prevent"])},[U,V,_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.value=t),name:"email",type:"text",class:"input"},null,512),[[m,o.value]]),q,_(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>i.value=t),name:"password",type:"text",class:"input"},null,512),[[m,i.value]]),e("button",{class:"btn",disabled:a.value},[a.value?(n(),l("span",H,[w(P)])):(n(),l("span",M," Login "))],8,B)],32)]))}};export{O as default};
